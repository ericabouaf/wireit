<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
WireIt Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Layer.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Layer.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		A layer encapsulate a bunch of containers and wires.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="WireIt/Layer.html">WireIt.Layer</a></b></td>
    <td>WireIt.Layer
 </td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * <span class="attrib">@fileoverview</span> A layer encapsulate a bunch of containers and wires.
 */</span>
<span class="comment">/**
 * <span class="attrib">@class</span> WireIt.Layer
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@param</span> {Object}   config   Configuration object (see the properties)
 */</span>
WireIt.Layer = <span class="reserved">function</span>(config) {
   
   <span class="comment">/**
    * Configuration object of the layer
    * &lt;ul&gt;
    *   &lt;li&gt;className: CSS class name for the layer element (default 'WireIt-Layer')&lt;/li&gt;
    *   &lt;li&gt;parentEl: DOM element that schould contain the layer (default document.body)&lt;/li&gt;
    *   &lt;li&gt;containers: array of container configuration objects&lt;/li&gt;  
    *   &lt;li&gt;wires: array of wire configuration objects&lt;/li&gt;
    * &lt;/ul&gt;
    */</span>
   <span class="reserved">this</span>.config = config || {};
   <span class="reserved">this</span>.config.className = <span class="reserved">this</span>.config.className || <span class="literal">'WireIt-Layer'</span>;
   <span class="reserved">this</span>.config.parentEl = <span class="reserved">this</span>.config.parentEl || document.body;
   <span class="reserved">this</span>.config.containers = <span class="reserved">this</span>.config.containers || [];
   <span class="reserved">this</span>.config.wires = <span class="reserved">this</span>.config.wires || [];
   
   <span class="comment">/**
    * List of all the WireIt.Container (or subclass) instances in this layer
    */</span>
   <span class="reserved">this</span>.containers = [];
   
   <span class="comment">/**
    * List of all the WireIt.Wire (or subclass) instances in this layer
    */</span>
   <span class="reserved">this</span>.wires = [];
   
   <span class="comment">/**
    * Layer DOM element
    */</span>
   <span class="reserved">this</span>.el = null;
   
   
   <span class="comment">/**
    * Event that is fired when a wire is added
    * You can register this event with myTerminal.eventAddWire.subscribe(function(e,params) { var wire=params[0];}, scope);
    */</span>
   <span class="reserved">this</span>.eventAddWire = new YAHOO.util.CustomEvent(<span class="literal">"eventAddWire"</span>);
   
   <span class="comment">/**
    * Event that is fired when a wire is removed
    * You can register this event with myTerminal.eventRemoveWire.subscribe(function(e,params) { var wire=params[0];}, scope);
    */</span>
   <span class="reserved">this</span>.eventRemoveWire = new YAHOO.util.CustomEvent(<span class="literal">"eventRemoveWire"</span>);
   
   
   <span class="reserved">this</span>.render();
   
   <span class="reserved">this</span>.initContainers();
   
   <span class="reserved">this</span>.initWires();
   
};

<span class="comment">/**
 * Create the dom of the layer and insert it into the parent element
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.render = <span class="reserved">function</span>() {
   
   <span class="reserved">this</span>.el = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.config.className} );
   
   <span class="reserved">this</span>.config.parentEl.appendChild(<span class="reserved">this</span>.el);
};


<span class="comment">/**
 * Create all the containers passed as config
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.initContainers = <span class="reserved">function</span>() {
   <span class="reserved">for</span>(var i = 0 ; i &lt; <span class="reserved">this</span>.config.containers.length ; i++) {
      <span class="reserved">this</span>.addContainer(<span class="reserved">this</span>.config.containers[i]);
   } 
};

<span class="comment">/**
 * Create all the wires passed in the config
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.initWires = <span class="reserved">function</span>() {
   <span class="reserved">for</span>(var i = 0 ; i &lt; <span class="reserved">this</span>.config.wires.length ; i++) {
      <span class="reserved">this</span>.addWire(<span class="reserved">this</span>.config.wires[i]);
   }
};

<span class="comment">/**
 * Instanciate a wire given its "xtype" (default to WireIt.Wire)
 * <span class="attrib">@param</span> {Object} wireConfig  Wire configuration object (see WireIt.Wire class for details)
 * <span class="attrib">@return</span> {WireIt.Wire} Wire instance build from the xtype
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.addWire = <span class="reserved">function</span>(wireConfig) {
   var type = eval(wireConfig.xtype || <span class="literal">"WireIt.Wire"</span>);
   
   var src = wireConfig.src;
   var tgt = wireConfig.tgt;
   
   var terminal1 = <span class="reserved">this</span>.containers[src.moduleId].terminals[src.terminalId];
   var terminal2 = <span class="reserved">this</span>.containers[tgt.moduleId].terminals[tgt.terminalId];
   
   var wire = new type( terminal1, terminal2, <span class="reserved">this</span>.el);
   wire.redraw();
   
   <span class="reserved">return</span> wire;
};

<span class="comment">/**
 * Instanciate a container given its "xtype": WireIt.Container (default) or a subclass of it.
 * <span class="attrib">@param</span> {Object} containerConfig  Container configuration object (see WireIt.Container class for details)
 * <span class="attrib">@return</span> {WireIt.Container} Container instance build from the xtype
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.addContainer = <span class="reserved">function</span>(containerConfig) {
   
   var type = eval(containerConfig.xtype || <span class="literal">"WireIt.Container"</span>);
   var container = new type(containerConfig, <span class="reserved">this</span>);
   
   <span class="reserved">this</span>.containers.push( container );
   
   <span class="comment">// Event listeners</span>
   container.eventAddWire.subscribe(<span class="reserved">this</span>.onAddWire, <span class="reserved">this</span>, true);
   container.eventRemoveWire.subscribe(<span class="reserved">this</span>.onRemoveWire, <span class="reserved">this</span>, true);
   
   <span class="reserved">return</span> container;
};

<span class="comment">/**
 * Remove a container
 * <span class="attrib">@param</span> {WireIt.Container} container Container instance to remove
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.removeContainer = <span class="reserved">function</span>(container) {
   var index = <span class="reserved">this</span>.containers.indexOf(container);
   <span class="reserved">if</span>( index != -1 ) {
      container.remove();
      <span class="reserved">this</span>.containers[index] = null;
      <span class="reserved">this</span>.containers = <span class="reserved">this</span>.containers.compact();
   }
};

<span class="comment">/**
 * Update the wire list when any of the containers fired the eventAddWire
 * <span class="attrib">@param</span> {Event} event The eventAddWire event fired by the container
 * <span class="attrib">@param</span> {Array} args This array contains a single element args[0] which is the added Wire instance
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.onAddWire = <span class="reserved">function</span>(event, args) {
   var wire = args[0];
   <span class="comment">// add the wire to the list if it isn't in</span>
   <span class="reserved">if</span>( <span class="reserved">this</span>.wires.indexOf(wire) == -1 ) {
      <span class="reserved">this</span>.wires.push(wire);
      <span class="comment">// Re-Fire an event at the layer level</span>
      <span class="reserved">this</span>.eventAddWire.fire(wire);
   }
};

<span class="comment">/**
 * Update the wire list when a wire is removed
 * <span class="attrib">@param</span> {Event} event The eventRemoveWire event fired by the container
 * <span class="attrib">@param</span> {Array} args This array contains a single element args[0] which is the removed Wire instance
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.onRemoveWire = <span class="reserved">function</span>(event, args) {
   var wire = args[0];
   var index = <span class="reserved">this</span>.wires.indexOf(wire);
   <span class="reserved">if</span>( index != -1 ) {
      <span class="reserved">this</span>.eventRemoveWire.fire(wire);
      <span class="reserved">this</span>.wires[index] = null;
      <span class="reserved">this</span>.wires = <span class="reserved">this</span>.wires.compact();
   }
};

<span class="comment">/**
 * Remove all the containers in this layer (and the associated terminals and wires)
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.removeAllContainers = <span class="reserved">function</span>() {
   <span class="reserved">for</span>(var i = <span class="reserved">this</span>.containers.length-1 ; i &gt;= 0 ; i--) {
      <span class="reserved">this</span>.removeContainer(<span class="reserved">this</span>.containers[i]);
   }
};



<span class="comment">/**
 * Return an object that represent the state of the layer including the containers and the wires
 * <span class="attrib">@return</span> {Obj} layer configuration
 */</span>
WireIt.Layer.<span class="reserved">prototype</span>.getWiring = <span class="reserved">function</span>() {
   
   var i;
   var obj = {containers: [], wires: []};
   
   <span class="reserved">for</span>( i = 0 ; i &lt; <span class="reserved">this</span>.containers.length ; i++) {
      obj.containers.push( <span class="reserved">this</span>.containers[i].getConfig() );
   }
   
   <span class="reserved">for</span>( i = 0 ; i &lt; <span class="reserved">this</span>.wires.length ; i++) {
      var wire = <span class="reserved">this</span>.wires[i];
      
      var wireObj = { 
         src: {moduleId: <span class="reserved">this</span>.containers.indexOf(wire.terminal1.container), terminalId: wire.terminal1.container.terminals.indexOf(wire.terminal1)}, 
         tgt: {moduleId: <span class="reserved">this</span>.containers.indexOf(wire.terminal2.container), terminalId: wire.terminal2.container.terminals.indexOf(wire.terminal2)} 
      };
      obj.wires.push(wireObj);
   }
   
   <span class="reserved">return</span> obj;
};
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Sat Jan 26 15:17:14 2008</div>
</body>
</html>
